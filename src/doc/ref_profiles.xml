<?xml version="1.0"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V5.0//EN" 
  "http://www.docbook.org/xml/5.0/dtd/docbook.dtd"
[
<!ENTITY % sgml.features "IGNORE">
<!ENTITY % xml.features "INCLUDE">
<!ENTITY % dbcent PUBLIC "-//OASIS//ENTITIES DocBook Character Entities V4.5//EN" "/opt/local/share/xml/docbook/4.5/dbcentx.mod">
%dbcent;
]>

<section xmlns:xi="http://www.w3.org/2001/XInclude">
	<title>Profiles</title>
  <para>
    A Profile is the basic grouping element in AMEE. A single profile is used to contain all data corresponding to a single entity 
    in a client application. This could be a person, a building, an organisation, etc.; 
    you are free to choose what a profile corresponds to in your application. You can create any number of separate 
    Profiles.
  </para>
  <para>
    A Profile is identified by its UID, which forms part of the URL for any operations that are performed on or inside the profile.
  </para>
	<section>
		<title>Properties</title>
		<table>
			<tr>
				<th>Property</th>
				<th>Description</th>
			</tr>
			<tr>					
				<td>UID</td>
				<td>A 12-letter unique identifier for the profile. See <xref linkend='uid_reference'/> for more information.</td>
			</tr>
			<tr>					
				<td>created</td>
				<td>The time and date on which the profile was created.</td>
			</tr>
			<tr>					
				<td>modified</td>
				<td>The time and date on which the profile was last modified. Note that this
				   does not track changes inside the profile, only to the profile resource 
				   itself.</td>
			</tr>
		</table>
	</section>
	<section>
		<title>Create Profile</title>
		<para>
			Used to create a new profile, in which ProfileItems can be stored.
		</para>
		<table class='requestdetails'>
			<tr>					
				<td>URL</td>
				<td>https://{server}.amee.com/profiles</td>
			</tr>
			<tr>					
				<td>HTTP Method</td>
				<td>POST</td>
			</tr>
			<tr>					
				<td>Request Content-Type</td>
				<td>application/x-www-form-urlencoded</td>
			</tr>
			<tr>
				<td>Response Content-Type</td>
				<td>application/json or application/xml</td>
			</tr>
			<tr>
				<td>Successful Response Code</td>
				<td>200 OK</td>
			</tr>
		</table>
		<section>
		  <title>Compulsory Parameters</title>
  		<table class='parameters'>
  			<tr>
					<th>Parameter</th>
					<th>Description</th>
  			</tr>
				<tr>					
					<td>profile</td>
					<td>Tells AMEE to create a profile. Should always be 'true'.</td>
				</tr>
  		</table>
    </section>
		<para>
		  The response body contains a JSON or XML description of the new profile.
		</para>
		<section role='tabbed'>
		  <section role='tab'>
  			<title>JSON</title>
  			<section role='httprequest'>
  			  <programlisting role='header'>
POST /profiles HTTP/1.1
Accept: application/json
Content-Type: application/x-www-form-urlencoded
Authorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ=
          </programlisting>
          <programlisting role='body'>
profile=true
          </programlisting>
        </section>
        <section role='httpresponse'>
          <programlisting role='header'>
HTTP/1.1 200 OK
Content-Type: application/json; charset=UTF-8
          </programlisting>
  			  <programlisting role='json-body'><xi:include href='samples/json/post_profiles.js' parse="text"/></programlisting>
			  </section>
  		</section>
  		<section role='tab'>
  			<title>XML</title>
  			<section role='httprequest'>
  			  <programlisting role='header'>
POST /profiles HTTP/1.1
Accept: application/xml
Content-Type: application/x-www-form-urlencoded
Authorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ=
          </programlisting>
          <programlisting role='body'>
profile=true
          </programlisting>
        </section>
        <section role='httpresponse'>
          <programlisting role='header'>
HTTP/1.1 200 OK
Content-Type: application/xml; charset=UTF-8
          </programlisting>
          <programlisting role='xml-body'><xi:include href='samples/xml/post_profiles.xml' parse="text"/></programlisting>
        </section>
  		</section>
  	</section>
	</section>
	<section>
		<title>List Profiles</title>
		<para>
			Lists all profiles available to the current user. Currently this is the list of all profiles
			created by the current user, but may in future depend on other permissions.
		</para>
		<table class='requestdetails'>
			<tr><td>URL</td><td>https://{server}.amee.com/profiles</td></tr>
			<tr><td>HTTP Method</td><td>GET</td></tr>
			<tr><td>Response Content-Type</td><td>application/xml or application/json</td></tr>
			<tr><td>Successful Response Code</td><td>200 OK</td></tr>
		</table>
		<para>
		  The response contains a JSON or XML encoded list of profiles for the current user.
	  </para>
		<section role='tabbed'>
		  <section role='tab'>
  			<title>JSON</title>
  			<section role='httprequest'>
  			  <programlisting role='header'>
GET /profiles HTTP/1.1
Accept: application/json
Authorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ=
          </programlisting>
    		</section>
  			<section role='httpresponse'>
  			  <programlisting role='header'>
HTTP/1.1 200 OK
Content-Type: application/json; charset=UTF-8
          </programlisting>
          <programlisting role='json-body'><xi:include href='samples/json/get_profiles.js' parse="text"/></programlisting>
		    </section>
  		</section>
		  <section role='tab'>
  			<title>XML</title>
  			<section role='httprequest'>
  			  <programlisting role='header'>
GET /profiles HTTP/1.1
Accept: application/xml
Authorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ=
          </programlisting>
    		</section>
  			<section role='httpresponse'>
  			  <programlisting role='header'>
HTTP/1.1 200 OK
Content-Type: application/xml; charset=UTF-8
          </programlisting>
          <programlisting role='xml-body'><xi:include href='samples/xml/get_profiles.xml' parse="text"/></programlisting>
		    </section>
  		</section>
		</section>
	</section>
	<section>
		<title>Delete Profile</title>
		<para>
			Completely remove the specified profile from the AMEE database, including all Profile Items contained within it. This information cannot be recovered after deletion.
		</para>			
		<table class='requestdetails'>
			<tr><td>URL</td><td>https://{server}.amee.com/profiles/{profile_uid}</td></tr>
			<tr><td>HTTP Method</td><td>DELETE</td></tr>
			<tr><td>Successful Response Code</td><td>200 OK</td></tr>
		</table>
		<section role='tabbed'>
		  <section role='tab'>
    		<title>Example</title>
  			<section role='httprequest'>
  			  <programlisting role='header'>
DELETE /profiles/358E3BCF690E HTTP/1.1
Accept: application/json, application/xml
Authorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ=
          </programlisting>
  			</section>
  			<section role='httpresponse'>
  			  <programlisting role='header'>
HTTP/1.1 200 OK
Content-Type: text/plain
          </programlisting>
  			</section>
  		</section>
		</section>
	</section>
</section>