<?xml version="1.0"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V5.0//EN" 
  "http://www.docbook.org/xml/5.0/dtd/docbook.dtd"
[
<!ENTITY % sgml.features "IGNORE">
<!ENTITY % xml.features "INCLUDE">
<!ENTITY % dbcent PUBLIC "-//OASIS//ENTITIES DocBook Character Entities V4.5//EN" "/usr/local/Cellar/docbook/5.0/docbook/xml/4.5/dbcentx.mod">
%dbcent;
<!ENTITY % translations   SYSTEM "translations.xml">
%translations;
]>

<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="profile-item-reference">
	<title>Profile Items</title>
	<para>
    Profile items represent individual instances of energy use or consumption. A client application
    will create a profile item for each item of energy use; the resulting object contains the emissions
    associated with that item of energy use.
  </para>
	<para>
    Profile items are contained inside Profile Categories, which in are contained inside Profiles. Profile
    items in turn contains Profile Item Values, which represent the individual inputs to the 
    calculation.
  </para>
	<section>
		<title>Properties</title>
		<table class="properties">
			<tr>
				<th>Property</th>
				<th>Description</th>
			</tr>
			<tr>
				<td>UID</td>
				<td>A 12-letter unique identifier for the profile item. See <xref linkend="uid-reference"/> for more information.</td>
			</tr>
			<tr>
				<td>created</td>
				<td>The time and date on which the profile item was created.</td>
			</tr>
			<tr>
				<td>modified</td>
				<td>The time and date on which the profile item was last modified.</td>
			</tr>
			<tr>
				<td>name</td>
				<td>The name of the item. Two items cannot have the same dataItemUid and 
				  overlapping dates unless they also have different names. Items with the
				  same name and dataItemUid are considered to be a time series.</td>
			</tr>
			<tr>
				<td>amounts</td>
				<td>A set of emission results for the item. This may include emissions separated by gas. See <xref linkend="profile-item-amounts-reference"/> for details.</td>
			</tr>
			<tr>
				<td>startDate</td>
				<td>The date/time from which the profile item is valid. See discussion of time series for more detail.</td>
			</tr>
			<tr>
				<td>endDate</td>
				<td>The date/time until which the profile item is valid. See discussion of time series for more detail.</td>
			</tr>
			<tr>
				<td>Data Item (dataItemUid)</td>
				<td>The data item which this profile item uses to obtain emission factors.</td>
			</tr>
		</table>
	</section>
	<section xml:id="profile-item-amounts-reference">
		<title>Results</title>
		<para>
      Profile Items can yield multiple return values, not just a single value. This is often used to 
      split up emissions for different gases, for instance carbon dioxide and methane.
    </para>
		<para>
      In the responses, these results are included in an 'amounts' object. See the examples below 
      for the exact XML and JSON representations. Each 'amount' returned has the following 
      properties:
    </para>
		<table>
			<tr>
				<td>type</td>
				<td>A description of the type of output. For instance, 'CO2'.</td>
			</tr>
			<tr>
				<td>value</td>
				<td>The value of the output.</td>
			</tr>
			<tr>
				<td>unit</td>
				<td>The units that the value field is measured in.</td>
			</tr>
			<tr>
				<td>default</td>
				<td>Optionally, this field is 'true' for the default result, often 
                              an aggregated total across different gases. This default is also 
                              included in the single 'amount' field in the response for backwards 
                              compatibility.</td>
			</tr>
		</table>
		<para>
      The 'amounts' section of the response can also contain 'note' objects. These provide other 
      textual information relevant to the result, for instance warning of errors, or clarifying 
      emission factors that were used.
    </para>
	</section>
	<section xml:id="create-profile-item-reference">
		<title>Create Profile Item</title>
		<para>
			Used to create a new profile item.
		</para>
		<table class="requestdetails">
			<tr>
				<td>URL</td>
				<td>https://{server}.amee.com/profiles/{profile_uid}/{category_path}</td>
			</tr>
			<tr>
				<td>HTTP Method</td>
				<td>POST</td>
			</tr>
			<tr>
				<td>Request Content-Type</td>
				<td>application/x-www-form-urlencoded</td>
			</tr>
			<tr>
				<td>Response Content-Type</td>
				<td>application/json or application/xml</td>
			</tr>
			<tr>
				<td>Successful Response Code</td>
				<td>201 CREATED</td>
			</tr>
		</table>
		<section>
			<title>Compulsory Parameters</title>
			<table class="parameters">
				<tr>
					<th>Parameter</th>
					<th>Description</th>
				</tr>
				<tr>
					<td>dataItemUid</td>
					<td>The UID of the Data Item which a new Profile Item should be based upon. This should be obtained from a drilldown request as described in <xref linkend="drilldown-reference"/>.</td>
				</tr>
			</table>
		</section>
		<section>
			<title>Optional Parameters</title>
			<table class="parameters">
				<tr>
					<th>Parameter</th>
					<th>Description</th>
				</tr>
				<tr>
					<td>{valueName}</td>
					<td>Set a Profile Item Value by specifying the name and value. For example, the value 
					  name could be 'distance' supplied with a value of '300'. Multiple name/value pairs
					  can be submitted so long as the named Item Values exist for the Profile Item. Names
					  and values are case sensitive.</td>
				</tr>
				<tr>
					<td>{valueName}Unit</td>
					<td>If a value is set, a unit can also be set. In the distance example above, the 
					  'distanceUnit' parameter could be set to 'km', 'mi', or any other supported distance 
					  unit. All values have default units if none are supplied.</td>
				</tr>
				<tr>
					<td>{valueName}PerUnit</td>
					<td>If a value is set, a perUnit can also be set, which indicates the timescale over which
					  the value applies. In the distance example above, the 'distancePerUnit' parameter could be
					  set to 'day', 'month', or any other supported time unit. Not all values support perUnits; check 
					  &discover; for each case. Relevant values have default perUnits if none are supplied.</td>
				</tr>
				<tr>
					<td>name</td>
					<td>Set the name of the item. You cannot create two items with the same dataItemUid and 
					  overlapping dates unless you give them a unique name. Items with the same name and dataItemUid
					  are considered to be a time series.</td>
				</tr>
				<tr>
					<td>startDate</td>
					<td>An ISO8601 date/time which specifies when the item should be valid from. This parameter is
					  compulsory if either endDate or duration are specified. Defaults to the current time.
					  See <xref linkend="dates-times-reference"/> for details of format.</td>
				</tr>
				<tr>
					<td>endDate</td>
					<td>An ISO8601 date/time which specifies when the item should be valid until. Defaults to
					  infinitely far in the future. See <xref linkend="dates-times-reference"/> for details of format.</td>
				</tr>
				<tr>
					<td>duration</td>
					<td>As an alternative to specifying an end time, you can specify the duration that the item 
					  should be valid for in ISO8601 duration format. See <xref linkend="duration-reference"/> for details.</td>
				</tr>
				<tr>
					<td>representation</td>
					<td>If set to 'full', the newly-created item will be returned in the response to the POST request.
					  By default, only a Location header is returned.</td>
				</tr>
			</table>
		</section>
		<para>
		  If the representation parameter is set to full, the response will include the details of the created item. 
		  Otherwise, a Location header is returned which indicates the URL of the new item.
		</para>
		<xi:include href="samples/post_3_profiles_UID_items_category=DEFRA_transport_fuel_methodology_fuel=petrol_values.volume=500_name=example_startDate=2011-01-05T00:00:00Z.xml"/>
	</section>
	<section xml:id="get-profile-item-reference">
		<title>Read Profile Item</title>
		<para>
			Used to fetch a representation of an existing profile item.
		</para>
		<table class="requestdetails">
			<tr>
				<td>URL</td>
				<td>https://{server}.amee.com/profiles/{profile_uid}/{category_path}/{profile_item_uid}</td>
			</tr>
			<tr>
				<td>HTTP Method</td>
				<td>GET</td>
			</tr>
			<tr>
				<td>Response Content-Type</td>
				<td>application/json or application/xml</td>
			</tr>
			<tr>
				<td>Successful Response Code</td>
				<td>200 OK</td>
			</tr>
		</table>
		<para>
		  The response includes a representation of the requested profile item.
		</para>
		<xi:include href="samples/get_3_profiles_UID_items_UID;amounts.xml"/>
	</section>
	<section xml:id="list-profile-items-reference">
		<title>List Profile Items</title>
		<para>
			Fetches all profile items in a particular category.
		</para>
		<table class="requestdetails">
			<tr>
				<td>URL</td>
				<td>https://{server}.amee.com/profiles/{profile_uid}/{category_path}</td>
			</tr>
			<tr>
				<td>HTTP Method</td>
				<td>GET</td>
			</tr>
			<tr>
				<td>Response Content-Type</td>
				<td>application/json or application/xml</td>
			</tr>
			<tr>
				<td>Successful Response Code</td>
				<td>200 OK</td>
			</tr>
		</table>
		<section>
			<title>Optional Parameters</title>
			<table class="parameters">
				<tr>
					<th>Parameter</th>
					<th>Description</th>
				</tr>
				<tr>
					<td>startDate</td>
					<td>Start and end dates can be used to define a "query window" for the request. This 
					  window affects which profile items will be returned in the response, and included 
					  in the total emission value. See parameters below for details. The date should be
					  specified in ISO8601 format. Default value is the start of the current month. If
					  endDate or duration are specified, this parameter is compulsory.
					  See <xref linkend="dates-times-reference"/> for details of format.</td>
				</tr>
				<tr>
					<td>endDate</td>
					<td>See startDate above. Should be specified in ISO8601 format. Defaults to
					  infinitely far in the future. See <xref linkend="dates-times-reference"/> for details of format.</td>
				</tr>
				<tr>
					<td>duration</td>
					<td>As an alternative to specifying an end time, you can specify the duration of the query
					  window in ISO8601 duration format. See <xref linkend="duration-reference"/> for details of format.</td>
				</tr>
				<tr>
					<td>selectby</td>
					<td>Setting this to 'start' will only include items which start during the query window. 
				    Setting 'end' will include only items which end during the window. The default behaviour 
				    is to include any item that intersects the query window.
				  </td>
				</tr>
				<tr>
					<td>mode</td>
					<td>Set the calculation mode used. By default, emission values for items are for the
					  whole item, not just the part of the item that intersects the query window. To
					  get just the emissions that took place during the query window, set this parameter
					  to 'prorata'.</td>
				</tr>
				<tr>
					<td>returnUnit</td>
					<td>Mass units that should be used for the calculation results. Specifying returnUnit=lb would
					  return lb/year instead of kg/year, for example. See the list of supported units for
					  more details. Default unit is kg.</td>
				</tr>
				<tr>
					<td>returnPerUnit</td>
					<td>Time units that should be used for the calculation results. Specifying returnPerUnit=month would
					  return kg/month instead of kg/year, for example. See the list of supported units for
					  more details. Default is per year.</td>
				</tr>
				<tr>
					<td>page</td>
					<td>If there is more than one page of profile items, retrieve the specified page. Default is 
					  to fetch page 1. See <xref linkend="paging-reference"/>.</td>
				</tr>
				<tr>
					<td>itemsPerPage</td>
					<td>Specify the number of profile items returned in a single page. Default is 
					  to fetch 10 items per page. See <xref linkend="paging-reference"/>.</td>
				</tr>
			</table>
		</section>
		<para>
		  The response describes the profile category and any items within it. A summed total of the default 
		  amounts in each item is provided in the response.
		</para>
		<xi:include href="samples/get_3_profiles_UID_items.xml"/>
	</section>
	<section xml:id="update-profile-item-reference">
		<title>Update Profile Item</title>
		<para>
			Used to update an existing profile item.
		</para>
		<table class="requestdetails">
			<tr>
				<td>URL</td>
				<td>https://{server}.amee.com/profiles/{profile_uid}/{category_path}/{profile_item_uid}</td>
			</tr>
			<tr>
				<td>HTTP Method</td>
				<td>PUT</td>
			</tr>
			<tr>
				<td>Request Content-Type</td>
				<td>application/x-www-form-urlencoded</td>
			</tr>
			<tr>
				<td>Response Content-Type</td>
				<td>application/json or application/xml</td>
			</tr>
			<tr>
				<td>Successful Response Code</td>
				<td>200 OK</td>
			</tr>
		</table>
		<section>
			<title>Optional Parameters</title>
			<table class="parameters">
				<tr>
					<th>Parameter</th>
					<th>Description</th>
				</tr>
				<tr>
					<td>{valueName}</td>
					<td>Set a Profile Item Value by specifying the name and value. For example, the value 
					  name could be 'distance' supplied with a value of '300'. Multiple name/value pairs
					  can be submitted so long as the named Item Values exist for the Profile Item. Names
					  and values are case sensitive.</td>
				</tr>
				<tr>
					<td>{valueName}Unit</td>
					<td>If a value is set, a unit can also be set. In the distance example above, the 
					  'distanceUnit' parameter could be set to 'km', 'mi', or any other supported distance 
					  unit. All values have default units if none are supplied.</td>
				</tr>
				<tr>
					<td>{valueName}PerUnit</td>
					<td>If a value is set, a perUnit can also be set, which indicates the timescale over which
					  the value applies. In the distance example above, the 'distancePerUnit' parameter could be
					  set to 'day', 'month', or any other supported time unit. Not all values support perUnits; check 
					  &discover; for each case. Relevant values have default perUnits if none are supplied.</td>
				</tr>
				<tr>
					<td>name</td>
					<td>Set the name of the item. You cannot create two items with the same dataItemUid and 
					  overlapping dates unless you give them a unique name. Items with the same name and dataItemUid
					  are considered to be a time series.</td>
				</tr>
				<tr>
					<td>startDate</td>
					<td>An ISO8601 date/time which specifies when the item should be valid from. This parameter is
					  compulsory if either endDate or duration are specified. Defaults to the current time.
					  See <xref linkend="dates-times-reference"/> for details of format.</td>
				</tr>
				<tr>
					<td>endDate</td>
					<td>An ISO8601 date/time which specifies when the item should be valid until. Defaults to
					  infinitely far in the future.
					  See <xref linkend="dates-times-reference"/> for details of format.</td>
				</tr>
				<tr>
					<td>duration</td>
					<td>As an alternative to specifying an end time, you can specify the duration that the item 
					  should be valid for in ISO8601 duration format. See <xref linkend="duration-reference"/> for details.</td>
				</tr>
				<tr>
					<td>representation</td>
					<td>If set to 'full', the newly-created item will be returned in the response to the POST request.
					  By default, only a Location header is returned.</td>
				</tr>
			</table>
		</section>
		<para>
		  If the representation parameter is set to full, the response will include the details of the created item. 
		  Otherwise, it will be empty.
		</para>
		<xi:include href="samples/put_3_profiles_UID_items_UID_values.volume=1000.xml"/>
	</section>
	<section xml:id="delete-profile-item-reference">
		<title>Delete Profile Item</title>
		<para>
			Completely remove the specified profile item from the AMEE database. This information cannot be recovered after deletion.
		</para>
		<table class="requestdetails">
			<tr>
				<td>URL</td>
				<td>https://{server}.amee.com/profiles/{profile_uid}/{category_path}/{profile_item_uid}</td>
			</tr>
			<tr>
				<td>HTTP Method</td>
				<td>DELETE</td>
			</tr>
			<tr>
				<td>Successful Response Code</td>
				<td>200 OK</td>
			</tr>
		</table>
		<xi:include href="samples/delete_3_profiles_UID_items_UID.xml"/>
	</section>
</section>
