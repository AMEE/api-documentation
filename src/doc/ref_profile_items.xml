<?xml version="1.0"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V5.0//EN" 
  "http://www.docbook.org/xml/5.0/dtd/docbook.dtd"
[
<!ENTITY % sgml.features "IGNORE">
<!ENTITY % xml.features "INCLUDE">
<!ENTITY % dbcent PUBLIC "-//OASIS//ENTITIES DocBook Character Entities V4.5//EN" "../../tools/dtd/dbcentx.mod">
%dbcent;
<!ENTITY % translations   SYSTEM "translations.ent">
%translations;
]>

<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="profile-item-reference">
	<title><phrase role='titleize'>&profile_items;</phrase></title>
	<para>
    <phrase role='capitalize'>&profile_items;</phrase> represent individual instances of energy use or consumption. A client application
    will create a &profile_item; for each item of energy use; the resulting object contains the emissions
    associated with that item of energy use. <phrase role='capitalize'>&profile_items;</phrase> are contained inside &profiles;.
  </para>
	<section>
		<title>Properties</title>
		<table class="properties">
			<tr>
				<th>Property</th>
				<th>Description</th>
				<th><link linkend='matrix-parameters'>Matrix Parameter</link></th>
			</tr>
			<tr>
				<td>UID</td>
				<td>A 12-letter unique identifier for the &profile_item;. See <xref linkend="uid-reference"/> for more information.</td>
				<td></td>
			</tr>
			<tr>
				<td>name</td>
				<td>The name of the &profile_item;. Two &profile_items; cannot have the same &category;, &drill_options; and 
				  overlapping dates unless they also have different names. <phrase role='capitalize'>&profile_items;</phrase> with the
				  same name and &category;/&drill_options; are considered to be a time series.</td>
				<td><code>name</code></td>
			</tr>
			<tr>
				<td>created</td>
				<td>The time and date on which the &profile_item; was created.</td>
				<td><code>audit</code></td>
			</tr>
			<tr>
				<td>modified</td>
				<td>The time and date on which the &profile_item; was last modified.</td>
				<td><code>audit</code></td>
			</tr>
			<tr>
				<td>amounts</td>
				<td>A set of &return_values; for the item. This may include emissions separated by gas. See <xref linkend="profile-item-amounts-reference"/> for details.</td>
				<td><code>amounts</code></td>
			</tr>
			<tr>
				<td>startDate</td>
				<td>The date/time from which the &profile_item; is valid; only used in prorata calculations. See <xref linkend="build-time-series"/> for more detail.</td>
				<td><code>dates</code></td>
			</tr>
			<tr>
				<td>endDate</td>
				<td>The date/time until which the &profile_item; is valid; only used in prorata calculations. See <xref linkend="build-time-series"/> for more detail.</td>
				<td><code>dates</code></td>
			</tr>
			<tr>
				<td>&category;</td>
				<td>The &category; which this &profile_item; uses to obtain &data_item_values;.</td>
				<td><code>category</code></td>
			</tr>
		</table>
	</section>
	<section xml:id="profile-item-amounts-reference">
		<title>Results</title>
		<para>
      <phrase role='capitalize'>&profile_items;</phrase> can yield multiple &return_values;, not just a single value. This is often used to 
      split up emissions for different gases, for instance carbon dioxide and methane.
    </para>
		<para>
      In the responses, these results are included in an 'amounts' object. See the examples below 
      for the exact XML and JSON representations. Each 'amount' returned has the following 
      properties:
    </para>
		<table class="properties">
			<tr>
				<td>type</td>
				<td>A description of the type of output. For instance, 'CO2'.</td>
			</tr>
			<tr>
				<td>value</td>
				<td>The value of the output.</td>
			</tr>
			<tr>
				<td>unit</td>
				<td>The units that the value field is measured in.</td>
			</tr>
			<tr>
				<td>default</td>
				<td>Optionally, this field is 'true' for the default result, often 
                              an aggregated CO2 equivalent total across different gases.</td>
			</tr>
		</table>
		<para>
      The <code>amounts</code> section of the response can also contain <code>note</code> objects. These provide other 
      textual information relevant to the result, for instance warning of errors, or clarifying 
      &data_item_values; that were used.
    </para>
	</section>
	<section xml:id="create-profile-item-reference">
		<title>Create &profile_item;</title>
		<para>
			Used to create a new &profile_item;.
		</para>
		<table class="requestdetails">
			<tr>
				<td>URL</td>
				<td><code>&api_url;/&api_version;/profiles/{profile_uid}/items</code></td>
			</tr>
			<tr>
				<td>HTTP Method</td>
				<td><code>POST</code></td>
			</tr>
			<tr>
				<td>Request Content-Type</td>
				<td><code>application/x-www-form-urlencoded</code></td>
			</tr>
			<tr>
				<td>Successful Response Code</td>
				<td>201 CREATED</td>
			</tr>
		</table>
		<section>
			<title>Body Parameters</title>
			<table class="parameters">
				<tr>
					<th>Parameter</th>
					<th>Description</th>
					<th>Required?</th>
				</tr>
				<tr>
					<td><code>category</code></td>
					<td>The wikiName of the &category; that should be used for calculation.</td>
					<td>&required;</td>
				</tr>
				<tr>
					<td><code>{&drill_options;}</code></td>
					<td>The &drill_options; for the &data_item; that should be used in the calculation.</td>
					<td>&required;</td>
				</tr>
				<tr>
					<td><code>values.{value_name}</code></td>
					<td>An &profile_item_value; to be used in the calculation. Any number can be specified in separate parameters.</td>
					<td>&required;</td>
				</tr>
				<tr>
					<td><code>units.{value_name}</code></td>
					<td>The unit that the relevant &profile_item_value; is measured in.</td>
					<td>&not_required;</td>
				</tr>
				<tr>
					<td><code>perUnits.{value_name}</code></td>
					<td>The perUnit (normally a time unit) that the relevant &profile_item_value; is measured in, if supported.</td>
					<td>&not_required;</td>
				</tr>
				<tr>
					<td><code>name</code></td>
					<td>Set the name of the &profile_item;. You cannot create two &profile_items; with the same &category;, &drill_options;, and
					  overlapping dates unless you give them a unique name.</td>
					<td>&not_required;</td>
				</tr>
				<tr>
					<td><code>startDate</code></td>
					<td>An ISO8601 date/time which specifies when the &profile_item; should be valid from. This parameter is
					  compulsory if either <code>endDate</code> or <code>duration</code> are specified. Defaults to the current time.
					  See <xref linkend="dates-times-reference"/> for details of format.</td>
					<td>&not_required;</td>
				</tr>
				<tr>
					<td><code>endDate</code></td>
					<td>An ISO8601 date/time which specifies when the &profile_item; should be valid until. Defaults to
					  infinitely far in the future. See <xref linkend="dates-times-reference"/> for details of format.</td>
					<td>&not_required;</td>
				</tr>
				<tr>
					<td><code>duration</code></td>
					<td>As an alternative to specifying an end time, you can specify the duration that the &profile_item; 
					  should be valid for in ISO8601 duration format. See <xref linkend="duration-reference"/> for details.</td>
					<td>&not_required;</td>
				</tr>
			</table>
		</section>
		<para>
		  The <code>Location</code> header indicates the URL of the new &profile_item;.
		</para>
		<xi:include href="samples/post_3_profiles_UID_items_category=DEFRA_transport_fuel_methodology_fuel=petrol_values.volume=500_name=example_startDate=2011-01-05T00:00:00Z.xml"/>
	</section>
	<section xml:id="get-profile-item-reference">
		<title>Read &profile_item;</title>
		<para>
			Used to fetch a representation of an existing &profile_item;.
		</para>
		<table class="requestdetails">
			<tr>
				<td>URL</td>
				<td><code>&api_url;/&api_version;/profiles/{profile_uid}/items/{profile_item_uid}</code></td>
			</tr>
			<tr>
				<td>HTTP Method</td>
				<td><code>GET</code></td>
			</tr>
			<tr>
				<td>Successful Response Code</td>
				<td><code>200 OK</code></td>
			</tr>
		</table>
		<para>
		  The response includes a representation of the requested &profile_item;. Matrix parameters can be used to customise the included
		  data.
		</para>
		<xi:include href="samples/get_3_profiles_UID_items_UID;amounts.xml"/>
		<para>
		  If you need the original &profile_item_values; back, you can use the values list resource:
		</para>
		<xi:include href="samples/get_3_profiles_UID_items_UID_values;itemValueDefinition.xml"/>
	</section>
	<section xml:id="list-profile-items-reference">
		<title>List &profile_items;</title>
		<para>
			Fetches all &profile_items; in a &profile;.
		</para>
		<table class="requestdetails">
			<tr>
				<td>URL</td>
				<td><code>&api_url;/&api_version;/profiles/{profile_uid}/items</code></td>
			</tr>
			<tr>
				<td>HTTP Method</td>
				<td><code>GET</code></td>
			</tr>
			<tr>
				<td>Successful Response Code</td>
				<td><code>200 OK</code></td>
			</tr>
		</table>
		<section>
			<title>Query Parameters</title>
			<table class="parameters">
				<tr>
					<th>Parameter</th>
					<th>Description</th>
					<th>Required?</th>
				</tr>
				<tr>
					<td><code>startDate</code></td>
					<td>Start and end dates can be used to define a "query window" for the request. This 
					  window affects which &profile_items; will be returned in the response, and included 
					  in the total emission value. See parameters below for details. The date should be
					  specified in ISO8601 format. Default value is the start of the current month. If
					  endDate or duration are specified, this parameter is compulsory.
					  See <xref linkend="dates-times-reference"/> for details of format.</td>
					<td>&not_required;</td>
				</tr>
				<tr>
					<td><code>endDate</code></td>
					<td>See startDate above. Should be specified in ISO8601 format. Defaults to
					  infinitely far in the future. See <xref linkend="dates-times-reference"/> for details of format.</td>
					<td>&not_required;</td>
				</tr>
				<tr>
					<td><code>duration</code></td>
					<td>As an alternative to specifying an end time, you can specify the duration of the query
					  window in ISO8601 duration format. See <xref linkend="duration-reference"/> for details of format.</td>
					<td>&not_required;</td>
				</tr>
				<tr>
					<td><code>selectby</code></td>
					<td>Setting this to 'start' will only include items which start during the query window. 
				    Setting 'end' will include only items which end during the window. The default behaviour 
				    is to include any item that intersects the query window.</td>
					<td>&not_required;</td>
				</tr>
				<tr>
					<td><code>mode</code></td>
					<td>Set the calculation mode used. By default, emission values for items are for the
					  whole item, not just the part of the item that intersects the query window. To
					  get just the emissions that took place during the query window, set this parameter
					  to 'prorata'.</td>
					<td>&not_required;</td>
				</tr>
				<tr>					
					<td><code>resultStart</code></td>
					<td>Zero-based index of the first result that should be returned. See 
						<xref linkend='paging'/>. Defaults to 0 if not specified.</td>
					<td>&not_required;</td>
				</tr>
				<tr>					
					<td><code>resultLimit</code></td>
					<td>Specifies the number of results to return in a single page. See 
						<xref linkend='paging'/>. Defaults to 50 if not specified..</td>
					<td>&not_required;</td>
				</tr>
			</table>
		</section>
		<xi:include href="samples/get_3_profiles_UID_items.xml"/>
	</section>
	<section xml:id="update-profile-item-reference">
		<title>Update &profile_item;</title>
		<para>
			Used to update an existing &profile_item;. Parameters are the same as for creation.
		</para>
		<table class="requestdetails">
			<tr>
				<td>URL</td>
				<td><code>&api_url;/&api_version;/profiles/{profile_uid}/items/{profile_item_uid}</code></td>
			</tr>
			<tr>
				<td>HTTP Method</td>
				<td><code>PUT</code></td>
			</tr>
			<tr>
				<td>Request Content-Type</td>
				<td><code>application/x-www-form-urlencoded</code></td>
			</tr>
			<tr>
				<td>Successful Response Code</td>
				<td><code>200 OK</code></td>
			</tr>
		</table>
		<xi:include href="samples/put_3_profiles_UID_items_UID_values.volume=1000.xml"/>
	</section>
	<section xml:id="delete-profile-item-reference">
		<title>Delete &profile_item;</title>
		<para>
			Completely remove the specified &profile_item; from the AMEE database. This information cannot be recovered after deletion.
		</para>
		<table class="requestdetails">
			<tr>
				<td>URL</td>
				<td><code>&api_url;/&api_version;/profiles/{profile_uid}/items/{profile_item_uid}</code></td>
			</tr>
			<tr>
				<td>HTTP Method</td>
				<td><code>DELETE</code></td>
			</tr>
			<tr>
				<td>Successful Response Code</td>
				<td><code>200 OK</code></td>
			</tr>
		</table>
		<xi:include href="samples/delete_3_profiles_UID_items_UID.xml"/>
	</section>
</section>
